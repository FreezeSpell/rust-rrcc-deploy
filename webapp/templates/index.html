<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="{{ url_for('static', filename='style.css') }}" rel="stylesheet">
    <title>RRCC</title>
</head>
<body>
    <div class="wrapper">
        <div class="main">
            <h1 align="center" id="header">Raid Cost Calculator</h1>
            <form align="center" method="POST">
                <select name="raidType" id="raidType" class="dropDowns">
                    <option value="explo">Explosive Raid</option>
                    <option value="eco">Eco Raid</option>
                </select>
                <select name="itemType" id="itemType" class="dropDowns">
                    <option value="deployable">Deployable</option>
                    <option value="vehicle">Vehicle</option>
                    <option value="building">Building</option>
                </select>
                <input type="text" name="getId" placeholder="Enter item..." id="inputbox" list="autoSuggest" required>
                <datalist id="autoSuggest" maxlength="3">
                    {% for item in items %}
                    <option value="{{ item }}">
                    {% endfor %}
                </datalist>
                <script>
                    document.getElementById('inputbox').addEventListener('keyup', function() {
                        var input = this.value;
                        var datalist = document.getElementById('autoSuggest');
                
                        // Clear previous options
                        datalist.innerHTML = '';
                
                        // Fetch new suggestions based on input
                        fetch("{{ url_for('static', filename='suggests.json') }}")
                            .then(response => response.json())
                            .then(suggestions => {
                                // Filter suggestions
                                var filteredSuggestions = suggestions.filter(function(suggestion) {
                                    return suggestion.toLowerCase().includes(input.toLowerCase());
                                });
                
                                // Create new options and add them to the datalist
                                filteredSuggestions.forEach(function(suggestion) {
                                    var option = document.createElement('option');
                                    option.value = suggestion;
                                    datalist.appendChild(option);
                                });
                            })
                            .catch(error => console.error('Error:', error));
                    });
                </script>
                <button type="submit" id="idSubmit" class="submitBtn" value="Submit">BOOM!</button>
            </form>
            <div id="breakLine">
                <hr>
            </div>
            <div id="output">
                {% autoescape false %}
                {% if result %}
                <p>{{ result }}</p>
                {% else %}
                <p>Error</p>
                {% endif %}
                {% endautoescape %}
            </div>
            <!-- <script>
                function sendData() {
                    var inputData = document.getElementById("inputbox").value;
    
                    var xhr = new XMLHttpRequest();
                    xhr.open("POST", "/webapp/script.py", true);
                    xhr.setRequestHeader('Content-Type', 'application/json');
                    xhr.onreadystatechange = function() {
                        if (xhr.readyState === 4 && xhr.status === 200) {
                            var json = JSON.parse(xhr.responseText);
                            document.getElementById("outputText").innerHTML = xhr.responseText;
                        }
                    };
                    xhr.send(JSON.stringify({inputData: inputData}));
                }
            </script> -->
        </div>
    </div>
</body>
</html>